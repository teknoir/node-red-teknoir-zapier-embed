<script type="text/html" data-template-name="zapier-embed">
    <div id="zapier-container"></div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('zapier-embed', {
        category: 'function',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "file.png",
        label: function() {
            return this.name || "zapier-embed";
        },
        oneditprepare: function() {
            // Load JS
            const script = document.createElement("script");
            script.type = "module";
            script.src = "https://cdn.zapier.com/packages/partner-sdk/v0/zapier-elements/zapier-elements.esm.js";
            document.head.appendChild(script);

            // Load CSS
            const stylesheet = document.createElement("link");
            stylesheet.rel = "stylesheet";
            stylesheet.href = "https://cdn.zapier.com/packages/partner-sdk/v0/zapier-elements/zapier-elements.css";
            document.head.appendChild(stylesheet);

            // Create and display zapier-full-experience
            const element = document.createElement("zapier-full-experience");
            element.clientId = "L7pEoNyAfU52IpWaSSksfAdDi71MYIlP16zGl8Zt";  
            element.theme = "light";
            element.appSelectionDisplay = "hide";
            element.zapLimit = "0";
            element.zapCreateFromScratchDisplay = "hide";
            const container = document.querySelector("#zapier-container");
            container.appendChild(element);
        }
    });
</script>
